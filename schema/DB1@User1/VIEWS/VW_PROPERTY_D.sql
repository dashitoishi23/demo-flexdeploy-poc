--------------------------------------------------------
--  DDL for View VW_PROPERTY_D
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "DW"."VW_PROPERTY_D" ("ROW_WID", "PROPERTY_SRC_KEY", "LIVE_FLAG", "LEAF_LEVEL", "SUITE", "SUITE_TYPE", "BUILDING", "FLOOR", "FLOOR_SRC_KEY", "SUITE_SRC_KEY", "BUILDING_SRC_KEY", "PROPERTY_TYPE", "PROPERTY_CODE", "PROPERTY_NAME", "ADDRESS1", "ADDRESS2", "CITY", "STATE", "COUNTRY", "ZIP_POSTAL_CODE", "ACQUIRED_DATE", "LEGAL_ENTITY", "LONGITUDE", "LATITUDE", "SAME_STORE", "DOMESTIC_INTRL", "STABILIZATION_DATE", "STABILIZED_CURRENT_YEAR", "STABILIZED_NEXT_YEAR", "DISPOSITION_DATE", "GLOBAL_MARKET", "MARKET", "REGION", "OWNERSHIP_TYPE", "LEASED_OWNED", "SOURCE_CURRENCY_PROPERTY", "HRIS_DIVISION", "ELT", "DIVISION", "ENTITY_TYPE", "COUNTRY_CODE", "OWNERSHIP_PERCENT", "PORTFOLIO_OWNERSHIP_PERCENTAGE", "LINE_OF_BUSINESS", "PROPERTY_MANAGER", "DATA_CENTER_MANAGER", "EXTERNALLY_REPORTED", "REGIONAL_MANAGER", "ENTITY_PARENT", "CAMPUS", "DIRECTOR", "REAL_ESTATE_MANAGER", "ASSISTANT_REM", "PROPERTY_ASSISTANT", "SITE_CODE", "FORMALLY_KNOWN_AS_SITE_CODE", "ASSET_MANAGER", "SAP_WAREHOUSE_CODE", "GEOGRAPHIC_DIVISION", "LEGAL_ENTITY_NAME", "REPORTED_REGION", "REPORTED_MARKET", "LOCKED", "LOCKED_TIMESTAMP", "SNAPSHOT_DATE", "CREATED_ON_DT", "CHANGED_ON_DT", "ETL_UPDATE_DT", "ETL_INSERT_DT", "ETL_PROC_WID", "DATASOURCE", "UNIT_TYPE_SRC_KEY", "UNIT_SRC_KEY", "UNIT_TYPE", "UNIT", "UNIT_DESC", "UNIT_STATUS", "MASTER_SITE_CODE", "LEGACY_SRC_KEY", "SNAPSHOT_PERIOD", "ADJUSTMENT_COMMENT", "UPDATED_BY") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  SELECT
DW.ROW_WID ,
DW.PROPERTY_SRC_KEY ,
DW.LIVE_FLAG ,
DW.LEAF_LEVEL ,
nvl( ADJ.SUITE , DW.SUITE ) SUITE ,
nvl( ADJ.SUITE_TYPE , DW.SUITE_TYPE ) SUITE_TYPE ,
nvl( ADJ.BUILDING , DW.BUILDING ) BUILDING ,
nvl( ADJ.FLOOR , DW.FLOOR ) FLOOR ,
DW.FLOOR_SRC_KEY ,
DW.SUITE_SRC_KEY ,
DW.BUILDING_SRC_KEY ,
nvl( ADJ.PROPERTY_TYPE , DW.PROPERTY_TYPE ) PROPERTY_TYPE ,
nvl( ADJ.PROPERTY_CODE , DW.PROPERTY_CODE ) PROPERTY_CODE ,
nvl( ADJ.PROPERTY_NAME , DW.PROPERTY_NAME ) PROPERTY_NAME ,
nvl( ADJ.ADDRESS1 , DW.ADDRESS1 ) ADDRESS1 ,
nvl( ADJ.ADDRESS2 , DW.ADDRESS2 ) ADDRESS2 ,
nvl( ADJ.CITY , DW.CITY ) CITY ,
nvl( ADJ.STATE , DW.STATE ) STATE ,
nvl( ADJ.COUNTRY , DW.COUNTRY ) COUNTRY ,
nvl( ADJ.ZIP_POSTAL_CODE , DW.ZIP_POSTAL_CODE ) ZIP_POSTAL_CODE ,
nvl( ADJ.ACQUIRED_DATE , DW.ACQUIRED_DATE ) ACQUIRED_DATE ,
nvl( ADJ.LEGAL_ENTITY , DW.LEGAL_ENTITY ) LEGAL_ENTITY ,
nvl( ADJ.LONGITUDE , DW.LONGITUDE ) LONGITUDE ,
nvl( ADJ.LATITUDE , DW.LATITUDE ) LATITUDE ,
nvl( ADJ.SAME_STORE , DW.SAME_STORE ) SAME_STORE ,
nvl( ADJ.DOMESTIC_INTRL , DW.DOMESTIC_INTRL ) DOMESTIC_INTRL ,
nvl( ADJ.STABILIZATION_DATE , DW.STABILIZATION_DATE ) STABILIZATION_DATE ,
nvl( ADJ.STABILIZED_CURRENT_YEAR , DW.STABILIZED_CURRENT_YEAR ) STABILIZED_CURRENT_YEAR ,
nvl( ADJ.STABILIZED_NEXT_YEAR , DW.STABILIZED_NEXT_YEAR ) STABILIZED_NEXT_YEAR ,
nvl( ADJ.DISPOSITION_DATE , DW.DISPOSITION_DATE ) DISPOSITION_DATE ,
nvl( ADJ.GLOBAL_MARKET , DW.GLOBAL_MARKET ) GLOBAL_MARKET ,
nvl( ADJ.MARKET , DW.MARKET ) MARKET ,
nvl( ADJ.REGION , DW.REGION ) REGION ,
nvl( ADJ.OWNERSHIP_TYPE , DW.OWNERSHIP_TYPE ) OWNERSHIP_TYPE ,
nvl( ADJ.LEASED_OWNED , DW.LEASED_OWNED ) LEASED_OWNED ,
nvl( ADJ.SOURCE_CURRENCY_PROPERTY , DW.SOURCE_CURRENCY_PROPERTY ) SOURCE_CURRENCY_PROPERTY ,
nvl( ADJ.HRIS_DIVISION , DW.HRIS_DIVISION ) HRIS_DIVISION ,
nvl( ADJ.ELT , DW.ELT ) ELT ,
nvl( ADJ.DIVISION , DW.DIVISION ) DIVISION ,
nvl( ADJ.ENTITY_TYPE , DW.ENTITY_TYPE ) ENTITY_TYPE ,
nvl( ADJ.COUNTRY_CODE , DW.COUNTRY_CODE ) COUNTRY_CODE ,
nvl( ADJ.OWNERSHIP_PERCENT , DW.OWNERSHIP_PERCENT ) OWNERSHIP_PERCENT ,
nvl( ADJ.PORTFOLIO_OWNERSHIP_PERCENTAGE , DW.PORTFOLIO_OWNERSHIP_PERCENTAGE ) PORTFOLIO_OWNERSHIP_PERCENTAGE ,
nvl( ADJ.LINE_OF_BUSINESS , DW.LINE_OF_BUSINESS ) LINE_OF_BUSINESS ,
nvl( ADJ.PROPERTY_MANAGER , DW.PROPERTY_MANAGER ) PROPERTY_MANAGER ,
nvl( ADJ.DATA_CENTER_MANAGER , DW.DATA_CENTER_MANAGER ) DATA_CENTER_MANAGER ,
nvl( ADJ.EXTERNALLY_REPORTED , DW.EXTERNALLY_REPORTED ) EXTERNALLY_REPORTED ,
nvl( ADJ.REGIONAL_MANAGER , DW.REGIONAL_MANAGER ) REGIONAL_MANAGER ,
nvl( ADJ.ENTITY_PARENT , DW.ENTITY_PARENT ) ENTITY_PARENT ,
nvl( ADJ.CAMPUS , DW.CAMPUS ) CAMPUS ,
nvl( ADJ.DIRECTOR , DW.DIRECTOR ) DIRECTOR ,
nvl( ADJ.REAL_ESTATE_MANAGER , DW.REAL_ESTATE_MANAGER ) REAL_ESTATE_MANAGER ,
nvl( ADJ.ASSISTANT_REM , DW.ASSISTANT_REM ) ASSISTANT_REM ,
nvl( ADJ.PROPERTY_ASSISTANT , DW.PROPERTY_ASSISTANT ) PROPERTY_ASSISTANT ,
nvl( ADJ.SITE_CODE , DW.SITE_CODE ) SITE_CODE ,
nvl( ADJ.FORMALLY_KNOWN_AS_SITE_CODE , DW.FORMALLY_KNOWN_AS_SITE_CODE ) FORMALLY_KNOWN_AS_SITE_CODE ,
nvl( ADJ.ASSET_MANAGER , DW.ASSET_MANAGER ) ASSET_MANAGER ,
nvl( ADJ.SAP_WAREHOUSE_CODE , DW.SAP_WAREHOUSE_CODE ) SAP_WAREHOUSE_CODE ,
nvl( ADJ.GEOGRAPHIC_DIVISION , DW.GEOGRAPHIC_DIVISION ) GEOGRAPHIC_DIVISION ,
nvl( ADJ.LEGAL_ENTITY_NAME , DW.LEGAL_ENTITY_NAME ) LEGAL_ENTITY_NAME ,
nvl( ADJ.REPORTED_REGION , DW.REPORTED_REGION ) REPORTED_REGION ,
nvl( ADJ.REPORTED_MARKET , DW.REPORTED_MARKET ) REPORTED_MARKET ,
DW.LOCKED ,
DW.LOCKED_TIMESTAMP ,
DW.SNAPSHOT_DATE ,
DW.CREATED_ON_DT ,
DW.CHANGED_ON_DT ,
DW.ETL_UPDATE_DT ,
DW.ETL_INSERT_DT ,
DW.ETL_PROC_WID ,
DW.DATASOURCE ,
DW.UNIT_TYPE_SRC_KEY ,
DW.UNIT_SRC_KEY ,
nvl( ADJ.UNIT_TYPE , DW.UNIT_TYPE ) UNIT_TYPE ,
nvl( ADJ.UNIT , DW.UNIT ) UNIT ,
nvl( ADJ.UNIT_DESC , DW.UNIT_DESC ) UNIT_DESC ,
initcap(nvl( ADJ.UNIT_STATUS , DW.UNIT_STATUS )) UNIT_STATUS ,
nvl( ADJ.MASTER_SITE_CODE , DW.MASTER_SITE_CODE ) MASTER_SITE_CODE ,
DW.LEGACY_SRC_KEY ,
DW.SNAPSHOT_PERIOD ,
ADJ.ADJUSTMENT_COMMENT  ADJUSTMENT_COMMENT,
ADJ.UPDATED_BY UPDATED_BY
FROM
W_PROPERTY_D DW
LEFT OUTER JOIN W_PROPERTY_ADJ_D ADJ ON ADJ.ROW_WID = DW.ROW_WID
;
  GRANT READ ON "DW"."VW_PROPERTY_D" TO "ODS";
  GRANT READ ON "DW"."VW_PROPERTY_D" TO "DW_RO";
