--------------------------------------------------------
--  DDL for View VW_OA_ERP_NA_COLO_MVP
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "DW"."VW_OA_ERP_NA_COLO_MVP" ("DATE_ID", "SOURCEKEY", "DATESK", "PROPERTYCODE", "PROPERTY", "PHYSICALADDRESS", "ACQUIRED", "DIVISION", "REGION", "MARKET", "BUILDINGTYPE", "OWNERSHIPTYPE", "OWNERSHIPPERCENT", "SAMESTORE", "STABILIZATIONDATE", "STABILIZED", "SUNIT", "UNITTYPE", "UNITTYPEGROUP", "UNITTYPEDESC", "STATUS", "RENTABLESQFT", "RAISEDFLOORSQFT", "LOADFACTOR", "RENTABLESQM", "KW", "SFDISTRIBUTION", "SROOTCUSTOMER", "ROOTCUSTOMERNAME", "CUSTOMER_CODE", "CUSTOMERNAME", "INDUSTRYCLASS", "LEASETCODE", "LEASENAME", "LEASETYPE", "DATELEASESIGN", "DATELEASESTART", "DATELEASEEND", "AMENDMENTTYPE", "DATEAMENDMENTSIGN", "DATEAMENDMENTSTART", "DATEAMENDMENTORIGINALSTART", "DATEAMENDMENTEND", "DATEAMENDMENTEXPIRE", "DATEAMENDMENTEXPIREREPORTED", "DATEEXPIRATIONYEAR", "EXPIRATIONYEARGROUP", "MTM", "CURREXPLEASEUNITTERMINMONTHS", "FULLLEASEUNITTERMINMONTHS", "LEASEREMAININGTERM", "EXCHANGERATE", "CURRENCYCODE", "MONTHLYRENTNATIVE", "MONTHLYRENTUSD", "MONTHLYGAAPRENTNATIVE", "MONTHLYGAAPRENTUSD", "RENTATEXPIRATIONNATIVE", "RENTATEXPIRATIONUSD", "CURRENTABRNATIVE", "CURRENTABRUSD", "EXPIRATIONABRNATIVE", "EXPIRATIONABRUSD", "MONTHLYTERMEDCONNECTIVITYNATIVE", "MONTHLYTERMEDCONNECTIVITYUSD", "MONTHLYNONTERMEDCONNECTIVITYNATIVE", "MONTHLYNONTERMEDCONNECTIVITYUSD", "MONTHLYCONNECTIVITYNATIVE", "MONTHLYCONNECTIVITYUSD", "ANNUALIZEDCONNECTIVITYNATIVE", "ANNUALIZEDCONNECTIVITYUSD", "CREATEDATE") DEFAULT COLLATION "USING_NLS_COMP"  AS 
  (select to_char(DATESK,'YYYYMMDD') as DATE_ID,
SOURCEKEY,
CASE WHEN to_char(DATESK,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(DATESK,'MM/DD/YYYY') END   DATESK,
PROPERTYCODE,
PROPERTY,
PHYSICALADDRESS,
(CASE WHEN to_char(ACQUIRED,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(ACQUIRED,'MM/DD/YYYY') END) ACQUIRED,
DIVISION,
REGION,
MARKET,
BUILDINGTYPE,
OWNERSHIPTYPE,
OWNERSHIPPERCENT,
SAMESTORE,
to_char(STABILIZATIONDATE,'MM/DD/YYYY') STABILIZATIONDATE ,
STABILIZED,
SUNIT,
UNITTYPE,
UNITTYPEGROUP,
UNITTYPEDESC,
STATUS,
RENTABLESQFT,
RAISEDFLOORSQFT,
LOADFACTOR,
RENTABLESQM,
KW,
SFDISTRIBUTION,
SROOTCUSTOMER,
ROOTCUSTOMERNAME,
CUSTOMER_CODE,
CUSTOMERNAME,
INDUSTRYCLASS,
LEASETCODE,
LEASENAME,
LEASETYPE,
CASE WHEN to_char(DATELEASESIGN,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(DATELEASESIGN,'MM/DD/YYYY') END  DATELEASESIGN,
CASE WHEN to_char(DATELEASESTART,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(DATELEASESTART,'MM/DD/YYYY') END DATELEASESTART,
CASE WHEN to_char(DATELEASEEND,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(DATELEASEEND,'MM/DD/YYYY') END DATELEASEEND,
AMENDMENTTYPE,
CASE WHEN to_char(DATEAMENDMENTSIGN,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(DATEAMENDMENTSIGN,'MM/DD/YYYY') END DATEAMENDMENTSIGN,
CASE WHEN to_char(DATEAMENDMENTSTART,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(DATEAMENDMENTSTART,'MM/DD/YYYY') END DATEAMENDMENTSTART,
CASE WHEN to_char(DATEAMENDMENTORIGINALSTART,'MM/DD/YYYY')= '01/01/1900' THEN NULL ELSE to_char(DATEAMENDMENTORIGINALSTART,'MM/DD/YYYY') END DATEAMENDMENTORIGINALSTART,
CASE WHEN to_char(DATEAMENDMENTEND,'MM/DD/YYYY') = '01/01/1900' THEN NULL ELSE to_char(DATEAMENDMENTEND,'MM/DD/YYYY')  END DATEAMENDMENTEND,
CASE WHEN to_char(DATEAMENDMENTEXPIRE,'MM/DD/YYYY') = '01/01/1900' THEN NULL ELSE to_char(DATEAMENDMENTEXPIRE,'MM/DD/YYYY') END DATEAMENDMENTEXPIRE,
CASE WHEN to_char(DATEAMENDMENTEXPIREREPORTED,'MM/DD/YYYY') = '01/01/1900' THEN NULL ELSE to_char(DATEAMENDMENTEXPIREREPORTED,'MM/DD/YYYY') END DATEAMENDMENTEXPIREREPORTED,
DATEEXPIRATIONYEAR,
EXPIRATIONYEARGROUP,
MTM,
CURREXPLEASEUNITTERMINMONTHS,
FULLLEASEUNITTERMINMONTHS,
LEASEREMAININGTERM,
EXCHANGERATE,
CURRENCYCODE,
MONTHLYRENTNATIVE,
MONTHLYRENTUSD,
MONTHLYGAAPRENTNATIVE,
MONTHLYGAAPRENTUSD,
RENTATEXPIRATIONNATIVE,
RENTATEXPIRATIONUSD,
CURRENTABRNATIVE,
CURRENTABRUSD,
EXPIRATIONABRNATIVE,
EXPIRATIONABRUSD,
MONTHLYTERMEDCONNECTIVITYNATIVE,
MONTHLYTERMEDCONNECTIVITYUSD,
MONTHLYNONTERMEDCONNECTIVITYNATIVE,
MONTHLYNONTERMEDCONNECTIVITYUSD,
MONTHLYCONNECTIVITYNATIVE,
MONTHLYCONNECTIVITYUSD,
ANNUALIZEDCONNECTIVITYNATIVE,
ANNUALIZEDCONNECTIVITYUSD,
CREATEDATE
FROM ODS.W_OA_ERP_EXTRACT_STG)
;
  GRANT SELECT ON "DW"."VW_OA_ERP_NA_COLO_MVP" TO "DW_RO";
  GRANT READ ON "DW"."VW_OA_ERP_NA_COLO_MVP" TO "DW_RO";
